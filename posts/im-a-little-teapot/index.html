<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NJ4Z2F0C3C"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-NJ4Z2F0C3C");
    </script>
    

    <link rel="apple-touch-icon" sizes="76x76" href="/ico/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/ico/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/ico/favicon-16x16.png" />
    <link rel="manifest" href="/ico/site.webmanifest" />
    <link rel="mask-icon" href="/ico/safari-pinned-tab.svg" color="#5bbad5" />

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title> peat dot org - I&#39;m a Little Teapot </title>
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body class="font-sans flex flex-col bg-zinc-50 px-5">
    <header class="max-w-4xl mx-auto w-full">
      <nav class="flex flex-row text-sm">
        <ul class="flex-initial">
          <li><a class="font-bold" href="/">peat dot org</a></li>
          
          <li><a href="/posts/">posts</a></li>
          
        </ul>
        <div class="grow"></div>
        <ul class="flex-initial">
          <li><a rel="me" href="https://bsky.app/profile/peat.org">bluesky</a></li>
          <li><a rel="me" href="https://twitter.com/peat">twitter</a></li>
          <li><a rel="me" href="https://mastodon.social/@peat">mastodon</a></li>
          <li><a rel="me" href="https://github.com/peat">github</a></li>
          <li><a rel="me" href="https://linkedin.com/in/peatbakke">linkedin</a></li>
        </ul>
      </nav>
    </header>
    <div class="max-w-4xl mx-auto w-full" id="content">
      <div class="bg-white py-5 px-10 border rounded-lg border-zinc-100 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5">


<img class="mb-10 mt-5 p-2 shadow-xl -rotate-1 border" src="/images/teapot-detail.jpg">

        

<h1 class="text-zinc-700 text-4xl drop-shadow-lg font-bold mt-8 mb-2">I&#39;m a Little Teapot</h1>
<h2 class="text-sm mb-8 italic">
  <ul>
    <li class="inline pr-2 text-zinc-700">April 25, 2023</li>
    
    <li class="inline px-1 text-blue-600"><a href="/tags/art">#art</a></li>
    
    <li class="inline px-1 text-blue-600"><a href="/tags/rust">#rust</a></li>
    
    <li class="inline px-1 text-blue-600"><a href="/tags/teapot">#teapot</a></li>
    
  </ul>
</h2>

<div id="single-content">
<p>My mom is an artist, and I grew up so deeply immersed in art that it almost felt like drowning &ndash;
submerged in gallery openings, endless museums, sitting for portraits, the ever present scent of
gesso and turpentine. By the time I left home I was burnt out on the abstract, the
metaphorical, and the allegorical. I was thoroughly jaded &ndash; why waste time on such things
when there were &ldquo;real&rdquo; problems to solve?</p>
<p>Decades later those long dormant seeds of artistic appreciation started to sprout. Now I love
<a href="https://en.wikipedia.org/wiki/Impressionism">impressionism</a>,
<a href="https://en.wikipedia.org/wiki/Pointillism">pointillism</a>,
<a href="https://en.wikipedia.org/wiki/Screen_printing">screen printing</a>,
<a href="https://en.wikipedia.org/wiki/Linocut">linocut</a>, and other creative ways of constructing beautiful
and recognizable images. My walls are covered with my mom&rsquo;s art, and I love how she shares her view
of the world.</p>
<p><img src="/images/peat-painting.jpg" alt="A painting of Peat as a child"></p>
<figcaption class="text-sm italic text-zinc-500 -mt-10 pl-3 mb-6">
    A much younger Peat, detail from a painting by Carolyn Wilhelm (aka Mom)
</figcaption>
<p>Loving art and being profoundly nerdy is a great combination. While I haven&rsquo;t spent my life practicing
oil painting or sculpture, I have been working in code for years, and I was once an aspiring
photographer. Last year I started working on a project to combine the two to generate abstract and
impressionistic images.</p>
<p>Over the course of the project I&rsquo;ve fallen in love with dots.</p>
<h2>Dots?</h2>
<p>Zoom in on this image and you&rsquo;ll see what I mean.</p>
<p><img src="/images/elcap-dots.jpg" alt="Black and white El Capitan rendered in dots"></p>
<figcaption class="text-sm italic text-zinc-500 -mt-10 pl-3 mb-6">
    El Capitan sunrise, rendered in dots.
</figcaption>
<p>I love this effect. It&rsquo;s pointillism meets <a href="https://en.wikipedia.org/wiki/Yayoi_Kusama">Kusama</a>
meets watercolor. With black and white photos it creates a rainy, somber look.</p>
<p>What the heck does all of this have to do with teapots?</p>
<p>It&rsquo;s my nod to the <a href="https://en.wikipedia.org/wiki/Utah_teapot">Utah Teapot</a>, a reference model used
for over 40 years in 3D rendering and computer graphics. I also love tea, so finding a fancy teapot
as the reference for my dot rendering software seemed like a natural fit.</p>
<p>After some Googling, I found this gorgeous bit of porcelain &hellip;</p>
<p><img src="/images/teapot-original.jpg" alt="Beautifully painted porcelain teapot"></p>
<figcaption class="text-sm italic text-zinc-500 -mt-10 pl-3 mb-6">
    Globular Teapot by Orest Kurliukov - CC Zero, <a href="https://art.thewalters.org/detail/82411/globular-teapot/">The Walters Museum</a>
</figcaption>
<p>(Tangent: props to The Walters Museum for using <a href="https://creativecommons.org/">Creative Commons</a> licenses
for their images. They
did a great job photographing their collection, and putting those images under Creative Commons means
people like you and I are free to use, remix, and otherwise reinterpret them to our own creative ends.
To those ends, all of my original content here is also released under a Creative Commons license. Click
the link in the footer to learn more.)</p>
<p>I chose this image for a few reasons &ndash; it has smooth gradients, sharp lines, and colorful patterns. The
original is also fairly high resolution with plenty of detail to work with.</p>
<p>I went into this with a very basic idea: how can I recreate an image using simple shapes? I wasn&rsquo;t aiming
for stacked dots, but that&rsquo;s where this experiment ended up, and I love it.</p>
<p>I&rsquo;m a little sad I didn&rsquo;t keep the &ldquo;work in progress&rdquo; images while I was working through the discovery
process. It took several days of trying different ideas, and hundreds of failures and dead-end ideas
that didn&rsquo;t pan out.</p>
<p>After a rather winding route, here&rsquo;s my interpretation of the Globular Teapot, built with 45,000 dots.</p>
<p><img src="/images/teapot-full-dots.jpg" alt="The same teapot rendered in dots"></p>
<figcaption class="text-sm italic text-zinc-500 -mt-10 pl-3 mb-6">
    The dot rendered Globular Teapot
</figcaption>
<p>At first glance it just looks like a blurry version of the original. The joy of this process is when you
zoom in! The output is <em>extremely scalable</em> and the deeper you go, the more detail you find with layers
and layers of colorful dots.</p>
<p>The ultimate level of detail is constrained by the resolution of the original image of course; it can&rsquo;t
invent details that aren&rsquo;t there. Still, the abstract nature of the output lends itself to scaling far
beyond the point where the original image would be a chunky blur of colored pixels.</p>
<p><img src="/images/teapot-detail.jpg" alt="Detail of the dot rendered teapot"></p>
<figcaption class="text-sm italic text-zinc-500 -mt-10 pl-3 mb-6">
    Detail from the dot rendered Globular Teapot
</figcaption>
<h2 id="how-does-it-work">How does it work?</h2>
<p>The algorithm for building these images is pretty simple:</p>
<ol>
<li>Sample a random pixel in the source image.</li>
<li>Draw a big dot in the output image, centered at the same location and color as the sample pixel.</li>
<li>Compare that region of the output image to the source image, and if the output image is more similar than the previous version, keep it.</li>
<li>Repeat using ever shrinking dots to build up layers of texture and detail.</li>
</ol>
<p>Of course, the devil is in the details. Image similarity is fraught, and doing all of the
above <em>millions of times</em> to generate a final image with 50,000 circles is very inefficient.</p>
<p>Here&rsquo;s a 15 second video showing how the algorithm starts with big dots then works its way down to
tiny dots. At about three seconds in you start seeing splotches of color, at six seconds the overall shape
becomes apparent, and at ten seconds the details start to emerge.</p>
<video controls>
    <source src="/video/teapot-render-1080p.mp4" type="video/mp4"/>
    Video of rendering the dot teapot
</video>
<h2 id="wheres-the-code">Where&rsquo;s the code?</h2>
<p>The Rust source is on GitHub at <a href="https://github.com/peat/sediment">https://github.com/peat/sediment</a>. It&rsquo;s
a work in progress; I haven&rsquo;t been able to put in significant time in a few months, and there are a lot of
big sample images and renderings included in the repo.</p>
<p>Messiness aside, it has several different modes of operation &ndash;</p>
<p>First is <em>build</em> mode, which takes a configuration and a source image and generates a data file containing
the position, size, and color of the generated dots. There&rsquo;s a cross platform GUI (using the excellent
<a href="https://crates.io/crates/egui">egui</a> crate) that shows rendering progress and stats.</p>
<p>The second mode is <em>render</em>, which supports two different outputs: <a href="https://en.wikipedia.org/wiki/SVG">SVG</a>
as the vector format, and PNG as the rasterized format.</p>
<p>Someday I&rsquo;ll get around to writing a more compact representation and a javascript class for drawing and
navigating (zooming, panning) through the images. Beyond that &hellip; creating a WASM target that can build
and render just in the browser?</p>
<p>Hit me up on social media if you have questions, thoughts, or contributions. I&rsquo;d love to hear from ya!</p>

</div>



</div>
    </div>
    <footer class="flex flex-col max-w-4xl mx-auto w-full text-center text-sm w-full my-5 text-zinc-500">
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
        all original content licensed as creative commons - attribution,
        non-commercial
      </a>
      <p>copyright &copy; 2023 peat bakke</p>
    </footer>
  </body>
</html>
